classdef TopOptElementalDensityPrinter < CompositeResultsPrinter
    
    properties (Access = protected)
        simulationStr = 'TopOpt';
    end
    
    methods (Access = public)
        
        function obj = TopOptElementalDensityPrinter(d)
            obj.init(d);
        end
        
    end
    
    
    methods (Access = protected)
        
        function createPrinters(obj,d)
            p = ResultsPrinter.create('DensityGauss',d);
            obj.printers{1} = p;
        end
        
        function storeFieldsToPrint(obj,d)
            phyPr = d.cost.ShapeFuncs{1}.getPhysicalProblem();
            d.fields = obj.computeElementalDensity(d.x,phyPr);
            %d.quad = phyPr.element.quadrature;
            obj.printers{1}.storeFieldsToPrint(d)            
        end        
        
    end
    
    
    methods (Access = private, Static)
        
        function d = computeElementalDensity(x,phyPr)
            filter = FilterP0(x,phyPr); %Only examples with ls by the moment
            d = filter.getDens0();
        end
        
    end
    
end