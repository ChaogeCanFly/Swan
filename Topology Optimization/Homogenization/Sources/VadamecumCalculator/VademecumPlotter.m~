classdef VademecumPlotter < handle
    
    properties (Access = private)
        mxV
        myV
        C
        invP
        index
        iIndex
        jIndex
        tensor
        tensorComp
        tensorName
        tensorCase
        microName
        outPutPath        
        hasToPrint
        fig
    end
    
    
    methods (Access = public)
        
        function obj = VademecumPlotter
            obj.microName = 'SmoothRect';
            obj.init();
            obj.plotHomogenizedTensor();
            obj.plotAmplificatorTensor();
        end
    end
    
    
    methods (Access = private)
        
        function init(obj)
            obj.createOutPutPath();
            load([obj.microName,'.mat']);
            obj.index = [1 1; 2 2;3 3; 1 2;2 3;1 3];
            obj.mxV = linspace(0.01,0.99,15);
            obj.myV = linspace(0.01,0.99,15);
            obj.C = C;
            obj.invP = 1./C;
            obj.hasToPrint = true;
        end
        
        function createOutPutPath(obj)
            firstPart  = fullfile( '/home','alex','Dropbox');
            secondPart = fullfile('Amplificators','Images/');
            fullPath   = fullfile(firstPart,secondPart);            
            obj.outPutPath = fullPath;            
        end
        
        function plotHomogenizedTensor(obj)
            obj.tensor = obj.C;
            obj.tensorCase = 'C_';
            obj.plotTensor();
        end
        
        function plotAmplificatorTensor(obj)
            obj.tensor = obj.invP;
            obj.tensorCase = 'Pinv_';
            obj.plotTensor();
        end
        
        function plotTensor(obj)
            nPlot = length(obj.index);
            for iplot = 1:nPlot
                obj.obtainIJindex(iplot);
                obj.obtainTensorComponent();
                obj.createTensorName();
                obj.plotFigure();
                obj.printFigure();
            end
        end
        
        function obtainIJindex(obj,iplot)
            obj.iIndex = ind(iplot,1);
            obj.jIndex = ind(iplot,2);
        end
        
        function obtainTensorComponent(obj)
            i = obj.iIndex;
            j = obj.jIndex;
            Tij = obj.tensor(i,j,:,:);
            Tij = squeeze(Tij);
            obj.tensorComp = Tij;
        end
        
        function createTensorName(obj)
            i = obj.iIndex;
            j = obj.jIndex;            
            obj.tensorName = [obj.tensorCase,'{',num2str(i),num2str(j),'}'];
        end
        
        function addTitle(obj)
            tN = obj.tensorName;
            title([tN,' for ',obj.microName])
        end
        
        function plotFigure(obj,z)
            obj.fig = figure();
            x = obj.mxV;
            y = obj.myV;
            contour(x,y,z,50);
            xlabel('mx');
            ylabel('my');
            obj.addTitle();
            colorbar;
        end
        
        function printFigure(obj)
            if obj.hasToPrint
                outPutFigName = [obj.outPutPath,obj.tensorName];
                fp = figurePlotter(obj.fig,pL,xlabelName);
                fp.print(outPutFigName)                
            end
        end
        
    end
    
end