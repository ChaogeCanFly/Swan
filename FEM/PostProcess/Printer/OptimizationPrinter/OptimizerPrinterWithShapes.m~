classdef OptimizerPrinterWithShapes <  OptimizerPrinter
    
    methods (Access = protected)
        
        function [s,h,q] = obtainHasGaussDataAndQuad(obj)
            h = false;
            q = [];
            s = [];
            if obj.thereAreShapesToPrint(obj.shapeFuncs)
                nshapes = obj.obtainNumberOfShapesToPrint(obj.shapeFuncs);
                [sN,sF] = obj.obtainPrintableShapes(obj.shapeFuncs,nshapes);
                s = sN;
                [h,q] = obj.obtainQuadHasGaussData(sF{1});
            end
        end
        
        function createDataBaseForPostProcess(obj,ps,optimizer,printMode,hasGaussData))
            obj.dataBase = ps.getValue();
            obj.dataBase.ShapeNames = obj.shapesNames;
            obj.dataBase.optimizer  = optimizer;
            obj.dataBase.printMode  = printMode;
            obj.dataBase.hasGaussData = hasGaussData;
            
        end
        
        
    end
    
    
    
    methods (Access = private)
        
        function itHas = thereAreShapesToPrint(obj,shapeFuncs)
            itHas = false;
            for ishape = 1:numel(shapeFuncs)
                shapeFunc = shapeFuncs{ishape};
                if obj.isShapePrintable(shapeFunc)
                    itHas = true;
                    return
                end
            end
        end
        
        function n = obtainNumberOfShapesToPrint(obj,shapeFuncs)
            n = 0;
            for ishape = 1:numel(shapeFuncs)
                shapeName = class(shapeFuncs{ishape});
                switch shapeName
                    case {'ShFunc_NonSelfAdjoint_Compliance',...
                            'ShFunc_Compliance', ...
                            'ShFunc_Chomog_alphabeta',...
                            'ShFunc_Chomog_fraction'}
                        n = n +1;
                end
            end
        end
        
        function [sN,sF] = obtainPrintableShapes(obj,shapeFuncs,nshapes)
            shapesNamesToPrint = cell(nshapes,1);
            shapeFuncsToPrint = cell(nshapes,1);
            iprint = 0;
            for ishape = 1:nshapes
                shapeFunc = shapeFuncs{ishape};
                shapeName = class(shapeFunc);
                if obj.isShapePrintable(shapeFunc)
                    iprint = iprint + 1;
                    shapesNamesToPrint{iprint} = shapeName;
                    shapeFuncsToPrint{iprint}  = shapeFunc;
                end
            end
            sN = shapesNamesToPrint;
            sF = shapeFuncsToPrint;
        end
        
    end
    
    
end